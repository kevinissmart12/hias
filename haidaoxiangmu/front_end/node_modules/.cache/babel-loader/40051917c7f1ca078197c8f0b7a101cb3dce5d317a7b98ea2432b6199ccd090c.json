{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport time from '../../api/time';\nexport default {\n  name: \"Main\",\n  data() {\n    return {\n      tableItem: [{\n        'id': '1',\n        prop: 'uid',\n        label: '提交人',\n        width: '150'\n      }, {\n        'id': '2',\n        prop: 'type',\n        label: '类型',\n        width: '100'\n      }, {\n        'id': '3',\n        prop: 'op_obj',\n        label: '操作对象',\n        width: '150'\n      }, {\n        'id': '4',\n        prop: 'checkStatus',\n        label: '审核情况',\n        width: '100'\n      }, {\n        'id': '5',\n        prop: 'checkResult',\n        label: '审核结果',\n        width: '200'\n      }, {\n        'id': '6',\n        prop: 'time',\n        label: '时间',\n        width: '200'\n      }],\n      tempTableData: [],\n      currentPage: 1,\n      pagesize: 10,\n      length: 0,\n      dialogVisible: false,\n      //池塘 \n      pondTableItem: [{\n        'id': '1',\n        prop: 'number',\n        label: '区块编号',\n        width: '150'\n      }, {\n        'id': '2',\n        prop: 'lat',\n        label: '纬度',\n        width: '150'\n      }, {\n        'id': '3',\n        prop: 'lng',\n        label: '经度',\n        width: '150'\n      }, {\n        'id': '4',\n        prop: 'area',\n        label: '面积',\n        width: '150'\n      }, {\n        'id': '5',\n        prop: 'estimateArea',\n        label: '估算面积',\n        width: '150'\n      }, {\n        'id': '6',\n        prop: 'county',\n        label: '所在区/县',\n        width: '150'\n      }, {\n        'id': '7',\n        prop: 'town',\n        label: '所在镇',\n        width: '150'\n      }, {\n        'id': '8',\n        prop: 'village',\n        label: '所在村',\n        width: '150'\n      }, {\n        'id': '9',\n        prop: 'polygon',\n        label: '多边形',\n        width: '150'\n      }, {\n        'id': '10',\n        prop: 'ownerId',\n        label: '拥有者',\n        width: '150'\n      }, {\n        'id': '11',\n        prop: 'productId',\n        label: '养殖品种',\n        width: '150'\n      }, {\n        'id': '12',\n        prop: 'comment',\n        label: '留言',\n        width: '150'\n      }, {\n        'id': '13',\n        prop: 'checkStatus',\n        label: '审核状态',\n        width: '150'\n      }],\n      temppondTableData: [],\n      //拥有者\n      ownerTableItem: [{\n        'id': '1',\n        prop: 'name',\n        label: '名称/法人',\n        width: '150'\n      }, {\n        'id': '2',\n        prop: 'mobile',\n        label: '联系电话',\n        width: '150'\n      }, {\n        'id': '3',\n        prop: 'birthday',\n        label: '出生年月',\n        width: '150'\n      }, {\n        'id': '4',\n        prop: 'sex',\n        label: '性别',\n        width: '150'\n      }, {\n        'id': '5',\n        prop: 'imgUrl',\n        label: '图片',\n        width: '150'\n      }, {\n        'id': '6',\n        prop: 'address',\n        label: '家庭住址',\n        width: '150'\n      }, {\n        'id': '7',\n        prop: 'county',\n        label: '所在区/县',\n        width: '150'\n      }, {\n        'id': '8',\n        prop: 'town',\n        label: '所在镇',\n        width: '150'\n      }, {\n        'id': '9',\n        prop: 'village',\n        label: '所在村',\n        width: '150'\n      }, {\n        'id': '10',\n        prop: 'engagedTime',\n        label: '从业时间',\n        width: '150'\n      }, {\n        'id': '11',\n        prop: 'educationLevel',\n        label: '文化程度',\n        width: '150'\n      }, {\n        'id': '12',\n        prop: 'farmerTitle',\n        label: '农民头衔',\n        width: '150'\n      }, {\n        'id': '13',\n        prop: 'departmentId',\n        label: '组织机构代码',\n        width: '150'\n      }, {\n        'id': '14',\n        prop: 'discriminator',\n        label: '类型',\n        width: '150'\n      }, {\n        'id': '15',\n        prop: 'companyName',\n        label: '公司',\n        width: '150'\n      }, {\n        'id': '16',\n        prop: 'establishedTime',\n        label: '成立时间',\n        width: '150'\n      }, {\n        'id': '17',\n        prop: 'fixedAssets',\n        label: '固定资产',\n        width: '150'\n      }, {\n        'id': '18',\n        prop: 'businessContents',\n        label: '经营内容',\n        width: '150'\n      }, {\n        'id': '18',\n        prop: 'isBaseOfEmployee',\n        label: '无公害基地',\n        width: '150'\n      }, {\n        'id': '20',\n        prop: 'numberOfEmployee',\n        label: '员工人数',\n        width: '150'\n      }, {\n        'id': '21',\n        prop: 'featuredProducts',\n        label: '特色产品',\n        width: '150'\n      }, {\n        'id': '22',\n        prop: 'creditLevel',\n        label: '信用等级',\n        width: '150'\n      }, {\n        'id': '23',\n        prop: 'comment',\n        label: '备注',\n        width: '150'\n      }, {\n        'id': '24',\n        prop: 'checkStatus',\n        label: '审核状态',\n        width: '150'\n      }],\n      tempownerTableData: [],\n      //水产品\n      productTableItem: [{\n        'id': '1',\n        prop: 'name',\n        label: '水产品名称',\n        width: '150'\n      }, {\n        'id': '2',\n        prop: 'type',\n        label: '所属种类',\n        width: '150'\n      }, {\n        'id': '3',\n        prop: 'description',\n        label: '描述',\n        width: '150'\n      }, {\n        'id': '4',\n        prop: 'imgUrl',\n        label: '图片',\n        width: '150'\n      }, {\n        'id': '5',\n        prop: 'breedMethod',\n        label: '养殖方式',\n        width: '150'\n      }, {\n        'id': '6',\n        prop: 'breedTech',\n        label: '养殖技术',\n        width: '150'\n      }, {\n        'id': '7',\n        prop: 'diseases',\n        label: '疾病',\n        width: '150'\n      }],\n      tempProductTableData: []\n    };\n  },\n  methods: {\n    getDialog() {\n      let data = this.qs.stringify({\n        front: (this.currentPage - 1) * this.pagesize,\n        end: this.currentPage * this.pagesize\n      });\n      this.$axios({\n        url: '/api/dialog/getAll',\n        method: 'POST',\n        data: data\n      }).then(res => {\n        // console.log(res.data);\n        if (res.data.status == 200) {\n          this.tempTableData = res.data.data.data;\n          this.tempTableData.forEach((i, v) => {\n            i.time = time.time(i.time);\n            //类型\n            if (i.type == 0) {\n              i.type = '添加';\n            } else if (i.type == 1) {\n              i.type = '修改';\n            } else if (i.type == 2) {\n              i.type = '删除';\n            }\n            //操作对象\n            if (i.op_obj == 0) {\n              i.op_obj = '池塘信息';\n            } else if (i.op_obj == 1) {\n              i.op_obj = '拥有者信息';\n            } else if (i.op_obj == 2) {\n              i.op_obj = '水产品信息';\n            }\n            if (i.checkStatus == 0) {\n              i.checkStatus = '未审核';\n            } else if (i.checkStatus == 1) {\n              i.checkStatus = '已通过';\n            } else if (i.checkStatus == 2) {\n              i.checkStatus = '未通过';\n            }\n            this.UserData.forEach((ui, uv) => {\n              if (ui.id == i.uid) {\n                i.uid = ui.name;\n              }\n            });\n          });\n        }\n      });\n    },\n    getLength() {\n      this.$axios({\n        url: '/api/dialog/getLength',\n        method: 'GET'\n      }).then(res => {\n        this.length = res.data.data.data.length;\n        if (res.data.status == 200) {\n          this.getDialog();\n        }\n      });\n    },\n    getUser() {\n      this.$axios({\n        url: '/api/user/getAll',\n        method: 'GET'\n      }).then(res => {\n        console.log(res.data);\n        if (res.data.status == 200) {\n          this.$store.commit('dialog/setUserData', res.data.data.data);\n          this.getLength();\n          this.getAllTown();\n          this.getALlVillage();\n          this.getProduct();\n          this.getOwner();\n        }\n      });\n    },\n    //获取所有的镇和村\n    getAllTown() {\n      if (localStorage.getItem('town')) {\n        this.$store.commit('dialog/setTownData');\n      } else {\n        this.$axios({\n          url: '/api/area/getAllTown',\n          method: 'GET'\n        }).then(res => {\n          if (res.data.status == 200) {\n            //赋值\n            this.$store.commit('dialog/setTownData', res.data.data.data);\n          }\n        });\n      }\n    },\n    getALlVillage() {\n      if (localStorage.getItem('village')) {\n        this.$store.commit('dialog/setVillageData');\n      } else {\n        this.$axios({\n          url: '/api/area/getAllVillage',\n          method: 'GET'\n        }).then(res => {\n          if (res.data.status == 200) {\n            //赋值\n            this.$store.commit('dialog/setVillageData', res.data.data.data);\n          }\n        });\n      }\n    },\n    //获取product\n    getProduct() {\n      this.$axios({\n        url: '/api/products/getAll',\n        method: \"GET\"\n      }).then(res => {\n        if (res.data.status == 200) {\n          this.$store.commit('dialog/setProductData', res.data.data.data);\n        }\n      });\n    },\n    //获取owner\n    getOwner() {\n      this.$axios({\n        url: '/api/owner/getAll',\n        method: \"GET\"\n      }).then(res => {\n        if (res.data.status == 200) {\n          this.$store.commit('dialog/setOwnerData', res.data.data.data);\n        }\n      });\n    },\n    handleSizeChange(size) {\n      this.pagesize = size;\n      this.getDialog();\n    },\n    handleCurrentChange(currentPage) {\n      this.currentPage = currentPage;\n      this.getDialog();\n    },\n    check(item) {\n      // console.log(item,item.id,item.op_obj);\n      this.dialogVisible = true;\n      this.tempProductTableData = [];\n      this.temppondTableData = [];\n      this.tempownerTableData = [];\n      this.$store.commit('dialog/setCheckingData', item);\n      if (item.new_obj) {\n        console.log(item);\n        let new_obj = JSON.parse(item.new_obj);\n        //城镇信息\n        this.CountyData.forEach((ci, cv) => {\n          if (ci.id == new_obj.county) {\n            new_obj.county = ci.county;\n          }\n        });\n        this.TownData.forEach((ti, tv) => {\n          if (ti.id == new_obj.town) {\n            new_obj.town = ti.town;\n          }\n        });\n        this.VillageData.forEach((vi, vv) => {\n          if (vi.id == new_obj.village) {\n            new_obj.village = vi.village;\n          }\n        });\n        //修改用户\n        this.OwnerData.forEach((oi, ov) => {\n          if (oi.id == new_obj.ownerId) {\n            new_obj.ownerId = oi.name;\n          }\n        });\n        //水产品\n        this.ProductData.forEach((pi, pv) => {\n          if (pi.id == new_obj.productId) {\n            new_obj.productId = pi.name;\n          }\n        });\n        if (item.op_obj == '池塘信息') {\n          this.temppondTableData.push(new_obj);\n        } else if (item.op_obj == '拥有者信息') {\n          this.tempownerTableData.push(new_obj);\n        } else if (item.op_obj == '水产品信息') {\n          this.tempProductTableData.push(new_obj);\n        }\n      }\n      if (item.old_obj) {\n        let old_obj = JSON.parse(item.old_obj);\n        //城镇信息\n        this.CountyData.forEach((ci, cv) => {\n          if (ci.id == old_obj.county) {\n            old_obj.county = ci.county;\n          }\n        });\n        this.TownData.forEach((ti, tv) => {\n          if (ti.id == old_obj.town) {\n            old_obj.town = ti.town;\n          }\n        });\n        this.VillageData.forEach((vi, vv) => {\n          if (vi.id == old_obj.village) {\n            old_obj.village = vi.village;\n          }\n        });\n        //修改用户\n        this.OwnerData.forEach((oi, ov) => {\n          if (oi.id == old_obj.ownerId) {\n            old_obj.ownerId = oi.name;\n          }\n        });\n        //水产品\n        this.ProductData.forEach((pi, pv) => {\n          if (pi.id == old_obj.productId) {\n            old_obj.productId = pi.name;\n          }\n        });\n        if (item.op_obj == '池塘信息') {\n          this.temppondTableData.push(old_obj);\n        } else if (item.op_obj == '拥有者信息') {\n          this.tempownerTableData.push(old_obj);\n        } else if (item.op_obj == '水产品信息') {\n          this.tempProductTableData.push(old_obj);\n        }\n      }\n    },\n    pass() {\n      //修改\n      this.$axios({\n        url: '/api/dialog/update',\n        method\n      });\n    },\n    deny() {}\n  },\n  created() {\n    this.getUser();\n  },\n  computed: {\n    UserData() {\n      return this.$store.state.dialog.userData;\n    },\n    ProductData() {\n      return this.$store.state.dialog.productData;\n    },\n    OwnerData() {\n      return this.$store.state.dialog.ownerData;\n    },\n    CountyData() {\n      return this.$store.state.dialog.countyData;\n    },\n    TownData() {\n      return this.$store.state.dialog.townData;\n    },\n    VillageData() {\n      return this.$store.state.dialog.villageData;\n    },\n    CheckingData() {\n      return this.$store.state.dialog.checkingData;\n    }\n  }\n};","map":{"version":3,"mappings":";AA4FA;AACA;EACAA;EACAC;IACA;MACAC,YACA;QAAA;QAAAC;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,EACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACA;MACAC,gBACA;QAAA;QAAAR;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,EACA;MACAO;MACA;MACAC,iBACA;QAAA;QAAAV;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,EAEA;MACAS;MACA;MACAC,mBACA;QAAA;QAAAZ;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAA;QAAAF;QAAAC;QAAAC;MAAA,EACA;MACAW;IAEA;EACA;EACAC;IACAC;MACA;QACAC;QACAC;MACA;MACA;QACAC;QACAC;QACArB;MACA;QACA;QACA;UACA;UACA;YACAsB;YACA;YACA;cACAA;YACA;cACAA;YACA;cACAA;YACA;YACA;YACA;cACAA;YACA;cACAA;YACA;cACAA;YACA;YAEA;cACAA;YACA;cACAA;YACA;cACAA;YACA;YAEA;cACA;gBACAA;cACA;YACA;UACA;QACA;MACA;IACA;IACAC;MACA;QACAH;QACAC;MACA;QACA;QACA;UACA;QACA;MACA;IACA;IACAG;MACA;QACAJ;QACAC;MACA;QACAI;QACA;UACA;UACA;UACA;UACA;UACA;UACA;QACA;MACA;IACA;IACA;IACAC;MACA;QACA;MACA;QACA;UACAN;UACAC;QACA;UACA;YACA;YACA;UACA;QACA;MACA;IAEA;IACAM;MACA;QACA;MACA;QACA;UACAP;UACAC;QACA;UACA;YACA;YACA;UACA;QACA;MACA;IAEA;IACA;IACAO;MACA;QACAR;QACAC;MACA;QACA;UACA;QACA;MACA;IACA;IACA;IACAQ;MACA;QACAT;QACAC;MACA;QACA;UACA;QACA;MACA;IACA;IACAS;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;QACAP;QACA;QACA;QACA;UACA;YACAQ;UACA;QACA;QACA;UACA;YACAA;UACA;QACA;QACA;UACA;YACAA;UACA;QACA;QACA;QACA;UACA;YACAA;UACA;QACA;QACA;QACA;UACA;YACAA;UACA;QACA;QAEA;UACA;QACA;UACA;QACA;UACA;QACA;MACA;MACA;QACA;QACA;QACA;UACA;YACAC;UACA;QACA;QACA;UACA;YACAA;UACA;QACA;QACA;UACA;YACAA;UACA;QACA;QACA;QACA;UACA;YACAA;UACA;QACA;QACA;QACA;UACA;YACAA;UACA;QACA;QAEA;UACA;QACA;UACA;QACA;UACA;QACA;MACA;IACA;IACAC;MACA;MACA;QACAf;QACAC;MACA;IACA;IACAe,QAEA;EAEA;EACAC;IACA;EACA;EACAC;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;EACA;AACA","names":["name","data","tableItem","prop","label","width","tempTableData","currentPage","pagesize","length","dialogVisible","pondTableItem","temppondTableData","ownerTableItem","tempownerTableData","productTableItem","tempProductTableData","methods","getDialog","front","end","url","method","i","getLength","getUser","console","getAllTown","getALlVillage","getProduct","getOwner","handleSizeChange","handleCurrentChange","check","new_obj","old_obj","pass","deny","created","computed","UserData","ProductData","OwnerData","CountyData","TownData","VillageData","CheckingData"],"sourceRoot":"src/components/dialog","sources":["Main.vue"],"sourcesContent":["<template>\r\n    <div class=\"main\">\r\n        <el-card class=\"box-card\">\r\n            <div slot=\"header\" class=\"clearfix\">\r\n                <span>审核列表</span>\r\n            </div>\r\n            <el-table :data=\"tempTableData\" stripe style=\"width: 100%\">\r\n                <el-table-column\r\n                    :prop=\"item.prop\"\r\n                    :label=\"item.label\"\r\n                    :width=\"item.width\"\r\n                    v-for=\"(item,index) in tableItem\" \r\n                    :key=\"index\"\r\n                >\r\n                </el-table-column>\r\n                <el-table-column\r\n                    fixed=\"right\"\r\n                    label=\"操作\"\r\n                    width=\"120\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-button @click=\"check(scope.row)\" type=\"text\" size=\"small\">查看</el-button>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n        </el-card>\r\n        <!--  分页 -->\r\n        <el-pagination\r\n            @size-change=\"handleSizeChange\"\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page=\"currentPage\"\r\n            :page-size=\"pagesize\"\r\n            layout=\"total,prev, pager, next\"\r\n            :total=\"length\">\r\n        </el-pagination>\r\n\r\n        <el-dialog\r\n            title=\"具体信息\"\r\n            :visible.sync=\"dialogVisible\"\r\n            width=\"75%\"\r\n        >\r\n            <el-table v-if=\"tempProductTableData.length\" :data=\"tempProductTableData\" stripe style=\"width: 100%\">\r\n                <el-table-column\r\n                    :prop=\"item.prop\"\r\n                    :label=\"item.label\"\r\n                    :width=\"item.width\"\r\n                    v-for=\"(item,index) in productTableItem\" \r\n                    :key=\"index\"\r\n                >\r\n                    <template slot-scope=\"scope\">\r\n                        <img v-if=\"item.prop=='imgUrl'\" :src=\"scope.row.imgUrl\" alt=\"\" width=\"90\">\r\n                        <div v-else>{{scope.row[item.prop]}}</div>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n            <el-table v-if=\"temppondTableData.length\" :data=\"temppondTableData\" stripe style=\"width: 100%\">\r\n                <el-table-column\r\n                    :prop=\"item.prop\"\r\n                    :label=\"item.label\"\r\n                    :width=\"item.width\"\r\n                    v-for=\"(item,index) in pondTableItem\" \r\n                    :key=\"index\"\r\n                >\r\n                    <template slot-scope=\"scope\">\r\n                        <img v-if=\"item.prop=='imgUrl'\" :src=\"scope.row.imgUrl\" alt=\"\" width=\"90\">\r\n                        <div v-else>{{scope.row[item.prop]}}</div>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n            <el-table v-if=\"tempownerTableData.length\" :data=\"tempownerTableData\" stripe style=\"width: 100%\">\r\n                <el-table-column\r\n                    :prop=\"item.prop\"\r\n                    :label=\"item.label\"\r\n                    :width=\"item.width\"\r\n                    v-for=\"(item,index) in ownerTableItem\" \r\n                    :key=\"index\"\r\n                >\r\n                    <template slot-scope=\"scope\">\r\n                        <img v-if=\"item.prop=='imgUrl'\" :src=\"scope.row.imgUrl\" alt=\"\" width=\"90\">\r\n                        <div v-else>{{scope.row[item.prop]}}</div>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n\r\n            <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button type=\"primary\" @click=\"pass()\">通  过</el-button>\r\n                <el-button type=\"danger\" @click=\"deny()\">不通过</el-button>\r\n            </span>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport time from '../../api/time'\r\nexport default {\r\n    name:\"Main\",\r\n    data(){\r\n        return{\r\n            tableItem:[\r\n                {'id':'1',prop:'uid',label:'提交人',width:'150'},\r\n                {'id':'2',prop:'type',label:'类型',width:'100'},\r\n                {'id':'3',prop:'op_obj',label:'操作对象',width:'150'},\r\n                {'id':'4',prop:'checkStatus',label:'审核情况',width:'100'},\r\n                {'id':'5',prop:'checkResult',label:'审核结果',width:'200'},\r\n                {'id':'6',prop:'time',label:'时间',width:'200'}, \r\n            ],\r\n            tempTableData:[],\r\n            currentPage:1,\r\n            pagesize:10,\r\n            length:0,\r\n            dialogVisible:false,\r\n            //池塘 \r\n            pondTableItem:[\r\n                {'id':'1',prop:'number',label:'区块编号',width:'150'},\r\n                {'id':'2',prop:'lat',label:'纬度',width:'150'},\r\n                {'id':'3',prop:'lng',label:'经度',width:'150'},\r\n                {'id':'4',prop:'area',label:'面积',width:'150'},\r\n                {'id':'5',prop:'estimateArea',label:'估算面积',width:'150'},\r\n                {'id':'6',prop:'county',label:'所在区/县',width:'150'},\r\n                {'id':'7',prop:'town',label:'所在镇',width:'150'},\r\n                {'id':'8',prop:'village',label:'所在村',width:'150'},\r\n                {'id':'9',prop:'polygon',label:'多边形',width:'150'},\r\n                {'id':'10',prop:'ownerId',label:'拥有者',width:'150'},\r\n                {'id':'11',prop:'productId',label:'养殖品种',width:'150'},\r\n                {'id':'12',prop:'comment',label:'留言',width:'150'},\r\n                {'id':'13',prop:'checkStatus',label:'审核状态',width:'150'},\r\n            ],\r\n            temppondTableData:[],\r\n            //拥有者\r\n            ownerTableItem:[\r\n                {'id':'1',prop:'name',label:'名称/法人',width:'150'},\r\n                {'id':'2',prop:'mobile',label:'联系电话',width:'150'},\r\n                {'id':'3',prop:'birthday',label:'出生年月',width:'150'},\r\n                {'id':'4',prop:'sex',label:'性别',width:'150'},\r\n                {'id':'5',prop:'imgUrl',label:'图片',width:'150'},\r\n                {'id':'6',prop:'address',label:'家庭住址',width:'150'},\r\n                {'id':'7',prop:'county',label:'所在区/县',width:'150'},\r\n                {'id':'8',prop:'town',label:'所在镇',width:'150'},\r\n                {'id':'9',prop:'village',label:'所在村',width:'150'},\r\n                {'id':'10',prop:'engagedTime',label:'从业时间',width:'150'},\r\n                {'id':'11',prop:'educationLevel',label:'文化程度',width:'150'},\r\n                {'id':'12',prop:'farmerTitle',label:'农民头衔',width:'150'},\r\n                {'id':'13',prop:'departmentId',label:'组织机构代码',width:'150'},\r\n                {'id':'14',prop:'discriminator',label:'类型',width:'150'},\r\n                {'id':'15',prop:'companyName',label:'公司',width:'150'},\r\n                {'id':'16',prop:'establishedTime',label:'成立时间',width:'150'},\r\n                {'id':'17',prop:'fixedAssets',label:'固定资产',width:'150'},\r\n                {'id':'18',prop:'businessContents',label:'经营内容',width:'150'},\r\n                {'id':'18',prop:'isBaseOfEmployee',label:'无公害基地',width:'150'},\r\n                {'id':'20',prop:'numberOfEmployee',label:'员工人数',width:'150'},\r\n                {'id':'21',prop:'featuredProducts',label:'特色产品',width:'150'},\r\n                {'id':'22',prop:'creditLevel',label:'信用等级',width:'150'},\r\n                {'id':'23',prop:'comment',label:'备注',width:'150'},\r\n                {'id':'24',prop:'checkStatus',label:'审核状态',width:'150'},\r\n\r\n            ],\r\n            tempownerTableData:[],\r\n            //水产品\r\n            productTableItem:[\r\n                {'id':'1',prop:'name',label:'水产品名称',width:'150'},\r\n                {'id':'2',prop:'type',label:'所属种类',width:'150'},\r\n                {'id':'3',prop:'description',label:'描述',width:'150'},\r\n                {'id':'4',prop:'imgUrl',label:'图片',width:'150'},\r\n                {'id':'5',prop:'breedMethod',label:'养殖方式',width:'150'},\r\n                {'id':'6',prop:'breedTech',label:'养殖技术',width:'150'},\r\n                {'id':'7',prop:'diseases',label:'疾病',width:'150'},\r\n            ],\r\n            tempProductTableData:[],\r\n\r\n        }\r\n    },\r\n    methods:{\r\n        getDialog(){\r\n            let data=this.qs.stringify({\r\n                front:(this.currentPage-1)*this.pagesize,\r\n                end:this.currentPage*this.pagesize\r\n            })\r\n            this.$axios({\r\n                url:'/api/dialog/getAll',\r\n                method:'POST',\r\n                data:data\r\n            }).then(res=>{\r\n                // console.log(res.data);\r\n                if(res.data.status==200){\r\n                    this.tempTableData=res.data.data.data\r\n                    this.tempTableData.forEach((i,v)=>{\r\n                        i.time=time.time(i.time)\r\n                        //类型\r\n                        if(i.type==0){\r\n                            i.type='添加'\r\n                        }else if(i.type==1){\r\n                            i.type='修改'\r\n                        }else if(i.type==2){\r\n                            i.type='删除'\r\n                        }\r\n                        //操作对象\r\n                        if(i.op_obj==0){\r\n                            i.op_obj='池塘信息'\r\n                        }else if(i.op_obj==1){\r\n                            i.op_obj='拥有者信息'\r\n                        }else if(i.op_obj==2){\r\n                            i.op_obj='水产品信息'\r\n                        }\r\n\r\n                        if(i.checkStatus==0){\r\n                            i.checkStatus='未审核'\r\n                        }else if(i.checkStatus==1){\r\n                            i.checkStatus='已通过'\r\n                        }else if(i.checkStatus==2){\r\n                            i.checkStatus='未通过'\r\n                        }\r\n\r\n                        this.UserData.forEach((ui,uv)=>{\r\n                            if(ui.id==i.uid){\r\n                                i.uid=ui.name\r\n                            }\r\n                        })\r\n                    })\r\n                }\r\n            })\r\n        },\r\n        getLength(){\r\n            this.$axios({\r\n                url:'/api/dialog/getLength',\r\n                method:'GET',\r\n            }).then(res=>{\r\n                this.length=res.data.data.data.length\r\n                if(res.data.status==200){\r\n                    this.getDialog()\r\n                }\r\n            })\r\n        },\r\n        getUser(){\r\n            this.$axios({\r\n                url:'/api/user/getAll',\r\n                method:'GET'\r\n            }).then(res=>{\r\n                console.log(res.data);\r\n                if(res.data.status==200){\r\n                    this.$store.commit('dialog/setUserData',res.data.data.data)\r\n                    this.getLength()\r\n                    this.getAllTown()\r\n                    this.getALlVillage()\r\n                    this.getProduct()\r\n                    this.getOwner()\r\n                }\r\n            })\r\n        },\r\n        //获取所有的镇和村\r\n        getAllTown(){\r\n            if(localStorage.getItem('town')){\r\n                this.$store.commit('dialog/setTownData')\r\n            }else{\r\n                this.$axios({\r\n                    url:'/api/area/getAllTown',\r\n                    method:'GET',\r\n                }).then(res=>{\r\n                    if(res.data.status==200){\r\n                        //赋值\r\n                        this.$store.commit('dialog/setTownData',res.data.data.data)\r\n                    }\r\n                })\r\n            }\r\n            \r\n        },\r\n        getALlVillage(){\r\n            if(localStorage.getItem('village')){\r\n                this.$store.commit('dialog/setVillageData')\r\n            }else{\r\n                this.$axios({\r\n                    url:'/api/area/getAllVillage',\r\n                    method:'GET',\r\n                }).then(res=>{\r\n                    if(res.data.status==200){\r\n                        //赋值\r\n                        this.$store.commit('dialog/setVillageData',res.data.data.data)\r\n                    }\r\n                })\r\n            }\r\n\r\n        },\r\n        //获取product\r\n        getProduct(){\r\n            this.$axios({\r\n                url:'/api/products/getAll',\r\n                method:\"GET\",\r\n            }).then(res=>{\r\n                if(res.data.status==200){\r\n                    this.$store.commit('dialog/setProductData',res.data.data.data)\r\n                }\r\n            })\r\n        },\r\n        //获取owner\r\n        getOwner(){\r\n            this.$axios({\r\n                url:'/api/owner/getAll',\r\n                method:\"GET\",\r\n            }).then(res=>{\r\n                if(res.data.status==200){\r\n                    this.$store.commit('dialog/setOwnerData',res.data.data.data)\r\n                }\r\n            })\r\n        },        \r\n        handleSizeChange (size) {\r\n            this.pagesize = size;\r\n            this.getDialog()\r\n        },\r\n        handleCurrentChange (currentPage) {\r\n            this.currentPage = currentPage;\r\n            this.getDialog()\r\n        },\r\n        check(item){\r\n            // console.log(item,item.id,item.op_obj);\r\n            this.dialogVisible=true\r\n            this.tempProductTableData=[]\r\n            this.temppondTableData=[]\r\n            this.tempownerTableData=[]\r\n            this.$store.commit('dialog/setCheckingData',item)\r\n            if(item.new_obj){\r\n                console.log(item);\r\n                let new_obj=JSON.parse(item.new_obj)\r\n                //城镇信息\r\n                this.CountyData.forEach((ci,cv)=>{\r\n                    if(ci.id==new_obj.county){\r\n                        new_obj.county=ci.county\r\n                    }\r\n                })\r\n                this.TownData.forEach((ti,tv)=>{\r\n                    if(ti.id==new_obj.town){\r\n                        new_obj.town=ti.town\r\n                    }\r\n                })           \r\n                this.VillageData.forEach((vi,vv)=>{\r\n                    if(vi.id==new_obj.village){\r\n                        new_obj.village=vi.village\r\n                    }\r\n                })\r\n                //修改用户\r\n                this.OwnerData.forEach((oi,ov)=>{\r\n                    if(oi.id==new_obj.ownerId){\r\n                        new_obj.ownerId=oi.name\r\n                    }\r\n                })\r\n                //水产品\r\n                this.ProductData.forEach((pi,pv)=>{\r\n                    if(pi.id==new_obj.productId){\r\n                        new_obj.productId=pi.name\r\n                    }\r\n                })\r\n\r\n                if(item.op_obj=='池塘信息'){\r\n                    this.temppondTableData.push(new_obj)\r\n                }else if(item.op_obj=='拥有者信息'){\r\n                    this.tempownerTableData.push(new_obj)\r\n                }else if(item.op_obj=='水产品信息'){\r\n                    this.tempProductTableData.push(new_obj)\r\n                }\r\n            }\r\n            if(item.old_obj){\r\n                let old_obj=JSON.parse(item.old_obj)\r\n                //城镇信息\r\n                this.CountyData.forEach((ci,cv)=>{\r\n                    if(ci.id==old_obj.county){\r\n                        old_obj.county=ci.county\r\n                    }\r\n                })\r\n                this.TownData.forEach((ti,tv)=>{\r\n                    if(ti.id==old_obj.town){\r\n                        old_obj.town=ti.town\r\n                    }\r\n                })           \r\n                this.VillageData.forEach((vi,vv)=>{\r\n                    if(vi.id==old_obj.village){\r\n                        old_obj.village=vi.village\r\n                    }\r\n                })\r\n                //修改用户\r\n                this.OwnerData.forEach((oi,ov)=>{\r\n                    if(oi.id==old_obj.ownerId){\r\n                        old_obj.ownerId=oi.name\r\n                    }\r\n                })\r\n                //水产品\r\n                this.ProductData.forEach((pi,pv)=>{\r\n                    if(pi.id==old_obj.productId){\r\n                        old_obj.productId=pi.name\r\n                    }\r\n                })\r\n\r\n                if(item.op_obj=='池塘信息'){\r\n                    this.temppondTableData.push(old_obj)\r\n                }else if(item.op_obj=='拥有者信息'){\r\n                    this.tempownerTableData.push(old_obj)\r\n                }else if(item.op_obj=='水产品信息'){\r\n                    this.tempProductTableData.push(old_obj)\r\n                }\r\n            }\r\n        },\r\n        pass(){\r\n            //修改\r\n            this.$axios({\r\n                url:'/api/dialog/update',\r\n                method\r\n            })\r\n        },\r\n        deny(){\r\n\r\n        }\r\n\r\n    },\r\n    created(){\r\n        this.getUser()\r\n    },\r\n    computed:{\r\n        UserData(){\r\n            return this.$store.state.dialog.userData\r\n        },\r\n        ProductData(){\r\n            return this.$store.state.dialog.productData\r\n        },\r\n        OwnerData(){\r\n            return this.$store.state.dialog.ownerData\r\n        },\r\n        CountyData(){\r\n            return this.$store.state.dialog.countyData\r\n        },\r\n        TownData(){\r\n            return this.$store.state.dialog.townData\r\n        },\r\n        VillageData(){\r\n            return this.$store.state.dialog.villageData\r\n        },\r\n        CheckingData(){\r\n            return this.$store.state.dialog.checkingData\r\n        }\r\n    }\r\n}   \r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n    .main{\r\n        width: 100%;\r\n        height: 100%;\r\n    }\r\n\r\n    .demo-table-expand {\r\n        font-size: 0;\r\n    }\r\n    .demo-table-expand label {\r\n        width: 90px;\r\n        color: #99a9bf;\r\n    }\r\n    .demo-table-expand .el-form-item {\r\n        margin-right: 0;\r\n        margin-bottom: 0;\r\n        width: 50%;\r\n    }\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}